Create a `decision_options` vector with all the decision options for the park and communities surrounding the park. 

```{r decision_options_list}
# Define all decision options (each as a named vector)
decision_options_list <- list(
  control_access = c(1, 0, 0, 0, 0),
  provide_access_control_harvest = c(0, 1, 0, 0, 0),
  allow_access_forest_parts = c(0, 0, 1, 0, 0),
  allow_access_limited_time = c(0, 0, 0, 1, 0),
  provide_seedlings = c(0, 0, 0, 0, 1)
)
```

### Define `outcome_effects` matrix for outcomes for decisions and outcomes.

```{r outcome_effects}
# outcome_effects (rows: outcomes, cols: decisions)
outcome_effects <- matrix(
  c(
    #control_access, provide_access_control_harvest, allow_access_forest_parts, allow_access_limited_time, provide_seedlings
    # Species Conservation outcome_effects
    0.8, 0.6, 0.5, 0.6, 0.7,
    # Dietary Diversity outcome_effects
    -0.6, 0.5, 0.6, 0.6, 0.7,
    # Sustainable Food Environment outcome_effects
    -0.4, 0.6, 0.7, 0.8, 0.9,
    # Park Expenditure outcome_effects
    0.9, 0.4, 0.3, 0.3, 0.8,
    # Traditional Knowledge outcome_effects
    -0.9, 0.7, 0.6, 0.5, 0.4
  ),
  nrow = 5, byrow = TRUE,
  dimnames = list(
    c("SpeciesConservation", "DietaryDiversity", "SustainableFoodEnv", "ParkExpenditure", "TraditionalKnowledge"),
    c("control_access", "provide_access_control_harvest", "allow_access_forest_parts", "allow_access_limited_time", "provide_seedlings")
  )
)
```

#### Define a `variability_list` for each outcome.

```{r variability_list}
variability_list <- list(
  SpeciesConservation = function(n) 
    rnorm(n, mean = 0, sd = 0.05),  # Low uncertainty
  DietaryDiversity = function(n) 
    rnorm(n, mean = 0, sd = 0.1),     # Moderate uncertainty
  SustainableFoodEnv = function(n) 
    rnorm(n, mean = 0, sd = 0.08),  # Moderate uncertainty
  ParkExpenditure = function(n) 
    rnorm(n, mean = 0, sd = 0.2),      # High uncertainty
  TraditionalKnowledge = function(n) 
    rnorm(n, mean = 0, sd = 0.15)  # Moderate-high uncertainty
)
```

#### Run the simulation with the `variability_list`. 

```{r results}
source("functions/simulate_outcomes_for_decisions.R")
results <- simulate_outcomes_for_decisions(decision_options_list, outcome_effects, variability_list)
```

```{r control_conservation}
# Example: Access results for a specific decision and outcome
head(results$control_access$SpeciesConservation)  # "Control Access" and "Species Conservation"
```

```{r seedlings_diets}
# Example: Access results for a different decision and outcome
head(results$provide_seedlings$DietaryDiversity)  # "Provide Seedlings" and "Dietary Diversity"
```

<!-- #### Check for outcome effects -->

<!-- ```{r outcome_effects-bidens_pilosa} -->
<!-- species_data$bidens_pilosa$outcome_effects -->
<!-- ``` -->

<!-- Test with 5 random noise values for the `SpeciesConservation` outcome, based on the standard deviation (sd) defined in `species_params`. -->

<!-- ```{r SpeciesConservation_5} -->
<!-- # Test the Variability Function -->
<!-- species_data$bidens_pilosa$variability_list$SpeciesConservation(5) -->
<!-- ``` -->

<!-- Use the simulate_outcomes_for_decisions function with the processed data for `species_a` to simulate outcomes. -->

<!-- ```{r simulations_bidens_pilosa} -->

<!-- simulations_bidens_pilosa <- simulate_outcomes_for_decisions( -->
<!--   decision_options = decision_options_list, #defined above -->
<!--   outcome_effects = species_data$bidens_pilosa$outcome_effects, -->
<!--   variability_list = species_data$bidens_pilosa$variability_list -->
<!-- ) -->
<!-- ``` -->

We also reverse the expenses, since higher expenses are worse, they should appear as a negative result in the plot. 

<!-- ```{r data_mgmt} -->
<!-- # Prepare the data -->
<!-- source("functions/prepare_heatmap_data.R") -->
<!-- heatmap_data <- prepare_heatmap_data(simulations_bidens_pilosa) -->

<!-- # Flatten simulations_b_pilosa into a data frame -->
<!-- source("functions/flatten_results.R") -->
<!-- # Flatten simulations_b_pilosa -->
<!-- heatmap_data <- flatten_results(simulations_bidens_pilosa, species_data$bidens_pilosa$variability_list) -->

<!-- # reverse the expenses -->
<!-- heatmap_data <- heatmap_data %>% -->
<!--   mutate( -->
<!--     MeanValue = ifelse(Outcome == "ParkExpenditure", -MeanValue, MeanValue) -->
<!--   ) -->

<!-- ``` -->

<!-- ### Plot a heatmap  -->

<!-- Apply `plot_bubble_heatmap` -->

<!-- ```{r plot_bubble_heatmap} -->
<!-- source("functions/plot_bubble_heatmap.R") -->
<!-- plot_bubble_heatmap(heatmap_data, title = "Bubble Plot for Bidens pilosa") -->
<!-- ``` -->

### Plot an aggregated plot with `aggregate_species_data`

```{r aggregate_plot}
source("functions/aggregate_species_data.R")
# Aggregate data across all species
aggregated_data <- aggregate_species_data(species_files)

# Summarize aggregated data
summary_data <- aggregated_data %>%
  group_by(Decision, Outcome) %>%
  summarize(
    MeanEffect = mean(Effect, na.rm = TRUE),
    MeanSD = mean(SD, na.rm = TRUE),
    .groups = "drop"
  )

```

Apply `plot_aggregate_effects`

```{r plot_aggregate_effects}
library(ggplot2)
source("functions/plot_aggregate_effects.R")
# Plot the data
plot_aggregate_effects(summary_data)

```
